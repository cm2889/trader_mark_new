{% extends 'base.html' %}
{% block title %}Employee Import / Export{% endblock %}
{% block content %}
    <div class="min-h-screen bg-gray-50 px-6 py-10">
        <div class="max-w-5xl mx-auto">
            <!-- Page Header -->
            <div class="mb-8 text-center">
                <h1 class="text-3xl font-bold text-gray-800">Employee Data Management</h1>
                <p class="text-gray-500 mt-2">Upload, import, and export employee records securely</p>
            </div>
            <!-- Export Section -->
            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                <div class="flex items-center mb-6">
                    <svg class="w-6 h-6 text-green-600 mr-3"
                         fill="none"
                         stroke="currentColor"
                         viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4">
                        </path>
                    </svg>
                    <h2 class="text-xl font-semibold text-gray-800">Export Employee Data</h2>
                </div>
                <form method="GET"
                      action="{% url 'import_export:export_excel' %}"
                      id="exportForm">
                    <div class="mb-6">
                        <label for="export_company"
                               class="block text-sm font-medium text-gray-700 mb-2">Select Company to Export</label>
                        <select name="company_id"
                                id="export_company"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                required>
                            <option value="">-- Select Company --</option>
                            {% for company in companies %}
                                <option value="{{ company.id }}">{{ company.name }} ({{ company.code }})</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="flex justify-end">
                        <button type="submit"
                                class="px-8 py-3 bg-green-600 text-white font-semibold rounded-lg shadow hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed"
                                id="exportBtn"
                                disabled>
                            <svg class="w-5 h-5 inline-block mr-2 -mt-1"
                                 fill="none"
                                 stroke="currentColor"
                                 viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4">
                                </path>
                            </svg>
                            Export to Excel
                        </button>
                    </div>
                </form>
            </div>
            <!-- Upload Section -->
            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                <div class="flex items-center mb-6">
                    <svg class="w-6 h-6 text-blue-600 mr-3"
                         fill="none"
                         stroke="currentColor"
                         viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12">
                        </path>
                    </svg>
                    <h2 class="text-xl font-semibold text-gray-800">Import Employee Data</h2>
                </div>
                <form method="POST" enctype="multipart/form-data" id="uploadForm">
                    {% csrf_token %}
                    <label class="block w-full border-2 border-dashed border-gray-300 rounded-xl p-16 text-center cursor-pointer transition hover:border-blue-500 hover:bg-blue-50">
                        <input type="file"
                               name="excel_file"
                               id="fileInput"
                               accept=".xlsx,.xls,.csv"
                               class="hidden"
                               required>
                        <div class="space-y-3">
                            <svg class="mx-auto w-12 h-12 text-gray-400"
                                 fill="none"
                                 stroke="currentColor"
                                 stroke-width="1.5"
                                 viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 7.5m0 0L7.5 12m4.5-4.5V16.5" />
                            </svg>
                            <p class="text-lg font-medium text-gray-700" id="fileLabel">Drag & Drop your file here</p>
                            <p class="text-sm text-gray-400">Supported formats: XLSX, XLS, CSV</p>
                        </div>
                    </label>
                    <div class="mt-6 flex justify-center">
                        <button type="submit"
                                id="importBtn"
                                class="px-8 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow disabled:opacity-40 disabled:cursor-not-allowed hover:bg-blue-700 transition"
                                disabled>Import Employee Data</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script>
const fileInput = document.getElementById('fileInput');
const fileLabel = document.getElementById('fileLabel');
const importBtn = document.getElementById('importBtn');
const exportCompany = document.getElementById('export_company');
const exportBtn = document.getElementById('exportBtn');

fileInput.addEventListener('change', () => {
  if(fileInput.files.length){
    fileLabel.textContent = fileInput.files[0].name;
    importBtn.disabled = false;
  }
});

exportCompany.addEventListener('change', () => {
  exportBtn.disabled = !exportCompany.value;
});
    </script>
{% endblock %}
